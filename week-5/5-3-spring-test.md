# π”Έ 5-3 Spring Test

## ν†µν•©ν…μ¤νΈ

* μ •μ \
  λ‹¨μ„ ν…μ¤νΈλ³΄λ‹¤ λ” ν° λ™μ‘μ„ λ‹¬μ„±ν•κΈ° μ„ν•΄ μ—¬λ¬ λ¨λ“λ“¤μ„ λ¨μ•„ μ΄λ“¤μ΄ μλ„λ€λ΅ ν‘λ ¥ν•λ”μ§€ ν™•μΈν•λ” ν…μ¤νΈ
* νΉμ§•\
  1\) κ°λ°μκ°€ λ³€κ²½ν•  μ μ—†λ” λ¶€λ¶„κΉμ§€ λ¬¶μ–΄ κ²€μ¦ν•  λ• μ‚¬μ©ν•λ‹¤.\
  2\) DBμ— μ ‘κ·Όν•κ±°λ‚ μ „μ²΄ μ½”λ“μ™€ λ‹¤μ–‘ν• ν™κ²½μ΄ μ λ€λ΅ λ™μ‘ν•λ”μ§€ ν•„μ”ν• λ¨λ“  μ‘μ—…μ„ μν–‰ ν•  μ μλ‹¤.\
  3\) ν†µν•©ν…μ¤νΈκ°€ μ‘μ©ν”„λ΅κ·Έλ¨μ΄ μ™„μ „ν•κ² μ‘λ™ν•λ” κ±Έ λ¬΄μ΅°κ±΄ μ¦λ…ν•μ§„ μ•λ”λ‹¤.
* μ¥ / λ‹¨μ \
  1\) λ‹¨μ„ν…μ¤νΈμ—μ„ λ°κ²¬ν•κΈ° μ–΄λ ¤μ΄ λ²„κ·Έ(ν™κ²½κ³Ό κ΄€λ ¨λ λ²„κ·Έ λ“±)λ¥Ό μ°Ύμ„ μ μλ‹¤.\
  2\) λ‹¨μ„ν…μ¤νΈ λ³΄λ‹¤ λ” λ§μ€ μ½”λ“λ¥Ό ν…μ¤νΈν•κΈ° λ•λ¬Έμ— μ‹ λΆ°μ„±μ΄ λ–¨μ–΄μ§ μ μλ‹¤.\
  3\) μ–΄λ””μ„ μ—λ¬κ°€ λ°μƒν–λ”μ§€ ν™•μΈν•κΈ° μ‰½μ§€ μ•μ•„ μ μ§€λ³΄μ ν•κΈ°κ°€ νλ“¤λ‹¤.\

* μ‚¬μ©λ°©λ²•\
  @SpringBootTest μ–΄λ…Έν…μ΄μ…μΌλ΅ ν†µν•© ν…μ¤νΈλ¥Ό μ‘μ„±ν•  μ μλ‹¤.\

* κ°μΈμ μΈ μƒκ°(μ¶”κ°€μ μΈ μ§λ¬Έ λλ” λ‚΄μ©)\

* λ νΌλ°μ¤ λ¨μ\
  [https://amaran-th.github.io/Spring/\[Spring\]%20Test/](https://amaran-th.github.io/Spring/\[Spring]%20Test/)

## @Autowired

* μ •μ \
  μƒμ„±μ, Setter, ν•„λ“μ— μ΄ μ–΄λ…Έν…μ΄μ…μ„ λ¶™μΌ μ μκ³ , μ΄λ” μμ΅΄μ„±μ„ μ£Όμ…ν•λ” μ—­ν• μ„ ν•λ‹¤.\

*   μ‚¬μ©λ°©λ²•\
    1\. μƒμ„±μ μ£Όμ…(κ°€μ¥ κ¶μ¥λλ” λ°©λ²•)\
    &#x20;ν΄λμ¤μ μƒμ„±μμ— @Autowiredλ¥Ό λ¶™μ—¬ ν•΄λ‹Ή ν΄λμ¤ νƒ€μ…μ ν•„λ“λ“¤μ„ μ°Ύμ•„ λ“±λ΅ν•λ„λ΅ ν•λ‹¤.

    &#x20; μƒμ„±μκ°€ ν•λ‚μΌ κ²½μ° μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ΄μ§€ μ•μ•„λ„ ν•΄λ‹Ή μƒμ„±μλ¥Ό μλ™ μ£Όμ…μ λ€μƒμΌλ΅ μΈμ‹ν•λ‹¤.\
    2\. μμ •μ μ£Όμ…\
    Setterλ‚ λ©”μ„λ“μ— @Autowiredλ¥Ό λ¶™μ—¬ ν•΄λ‹Ή ν΄λμ¤ νƒ€μ…μ λΉμ„ μ°Ύμ•„μ™€ μμ΅΄μ„±μ„ μ£Όμ…ν•λ‹¤. \
    μƒμ„± μ‹μ  μ΄ν›„μ— λ©”μ„λ“λ¥Ό νΈμ¶ν•μ—¬ μμ΅΄μ„±μ„ λ³€κ²½ν•  μ μμΌλ‚ ν•„λ“κ°€ μ™Έλ¶€μ—μ„ λ³€κ²½λ  μ μλ‹¤λ” μ κ³Ό μμ΅΄μ„±μ΄ ν•„μ”ν• μ‹μ μ— μ£Όμ…λμ§€ μ•μ„ μ μλ‹¤λ” μ„ν—μ΄ μ΅΄μ¬ν•λ‹¤.\
    3\. ν•„λ“ μ£Όμ…\
    κ°€μ¥ κ°„λ‹¨ν•κ² μ£Όμ…ν•λ” λ°©λ²•μΌλ΅ ν•„λ“μ— @Autowiredλ¥Ό λ¶™μ—¬ μμ΅΄μ„±μ„ μ£Όμ…ν•λ” λ°©λ²•μ΄λ‹¤.\
    μ½”λ“λ” κ°€μ¥ κ°„κ²°ν•λ‚ μμ •μ μ£Όμ…κ³Ό λ§μ°¬κ°€μ§€λ΅ ν•„λ“κ°€ finalμ΄ μ•„λ‹λ―€λ΅ λ³€κ²½λ  μ—¬μ§€κ°€ μλ‹¤.

    &#x20;λ©”μ„λ“μ™€ ν•„λ“ μ£Όμ… μ‹μ λ©”μ„λ“, ν•„λ“μ μ ‘κ·Όμ μ–΄μλ” privateλ„ κ°€λ¥ν•λ‹¤.\

*   μƒμ„±μ μ£Όμ…μ΄ κ°€μ¥ κ¶μ¥λλ” μ΄μ 

    1. ν•„μμ μΈ μμ΅΄μ„±μ μ£Όμ… μ‹μ μ„ λ³΄μ¥ν•  μ μλ‹¤.
    2. ν•„λ“λ¥Ό finalλ΅ μ„ μ–Έμ΄ κ°€λ¥ν•μ—¬ μ™Έλ¶€μ—μ„μ λ³€κ²½ κ°€λ¥μ„±μ„ λ‚®μ¶λ‹¤.
    3. μμ΅΄μ„± μ£Όμ…μ΄ ν• κ³³(μƒμ„±μ)μ—μ„λ§ μΌμ–΄λ‚λ―€λ΅ ν•„μ”ν• μμ΅΄μ„±μ„ ν•κ³³μ—μ„ λ¨μ•„μ„ ν™•μΈν•  μ μλ‹¤.
    4. μμ μλ°” μ½”λ“λ΅μ ν…μ¤νΈκ°€ μ©μ΄ν•λ‹¤.
    5. Beanμ μν™ μ°Έμ΅° λ¬Έμ λ¥Ό λ°©μ§€ν•  μ μλ‹¤.


* λ νΌλ°μ¤ λ¨μ\
  [https://jaehee329.tistory.com/28](https://jaehee329.tistory.com/28)\


## @SpyBean

* μ •μ \
  SpyBeanμ€ given-when-thenμ—μ„ givenμ—μ„ μ„ μ–Έν• μ½”λ“λ¥Ό μ μ™Έν•κ³  λ¨λ‘ μ‹¤μ μ μ½”λ“λ¥Ό μ‚¬μ©ν•λ” κΈ°λ¥μ„ ν•λ‹¤.
* μ™ ν•„μ”ν•κ°€?\
  μ• ν”λ¦¬μΌ€μ΄μ…μ„ ν…μ¤νΈ ν•  λ• λ¶ν•„μ”ν• λ©”μ„λ“λ“¤λ„ κ°™μ΄ ν…μ¤νΈκ°€ μ΄λ£¨μ–΄μ§€κΈ° λ•λ¬Έμ— νΉμ • λ¶€λ¶„μ„ μ μ™Έν•κ³  ν¨μ¨μ μΌλ΅ ν…μ¤νΈν•κΈ° μ„ν•΄ ν•„μ”ν•λ‹¤.
* νΉμ§•\

* μ‚¬μ©μμ‹\

* κ°μΈμ μΈ μƒκ°(μ¶”κ°€μ μΈ μ§λ¬Έ λλ” λ‚΄μ©)\
  λΉ„κµμ  μ μ™Έν•  λ‚΄μ©μ΄λ‚ λ©”μ„λ“κ°€ μ μ„ λ• SpyBeanμ„ μ‚¬μ©ν•΄μ•Ό λλ” κ²ƒ κ°™λ‹¤.
* λ νΌλ°μ¤ λ¨μ\
  [https://jojoldu.tistory.com/226](https://jojoldu.tistory.com/226)\
  [https://kth990303.tistory.com/370](https://kth990303.tistory.com/370)

## MockMvc

* μ •μ \
  Spring MVC μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ APIλ¥Ό μ‘μ„±ν•  λ•, MockMvcλ¥Ό μ‚¬μ©ν•μ—¬ APIμ ν…μ¤νΈλ¥Ό μν–‰ν•  μ μλ‹¤. μ¦‰, API ν…μ¤νΈ λ°©λ²•μ΄λ‹¤.
* μ™ ν•„μ”ν•κ°€?\
  MockMvcλ¥Ό μ‚¬μ©ν•λ©΄, APIλ¥Ό μ‹¤μ λ΅ νΈμ¶ν•μ§€ μ•κ³ λ„ APIμ λ™μ‘μ„ μ‹λ®¬λ μ΄μ…ν•μ—¬ APIμ λ™μ‘μ„ κ²€μ¦ν•  μ μλ‹¤.
* νΉμ§•\

* μ‚¬μ©μμ‹\

* κ°μΈμ μΈ μƒκ°(μ¶”κ°€μ μΈ μ§λ¬Έ λλ” λ‚΄μ©)\

* λ νΌλ°μ¤ λ¨μ\
  [https://cordcat.tistory.com/90](https://cordcat.tistory.com/90)

## MockBean

* μ •μ \
  Mockμ€ κ»λ°κΈ°λ§ μλ” κ°μ²΄λ¥Ό μλ―Έν•λ©°, MockBeanμ€ givenμ—μ„ μ„ μ–Έν• μ½”λ“ μ™Έμ—λ” λ¨λ‘ κ°€μ§ κ°μ²΄λ΅ λ§λ“¤μ–΄μ„ ν•„μ”ν• λ¶€λ¶„λ§ ν…μ¤νΈν•κ² ν•΄μ£Όλ” μ—­ν• μ„ ν•©λ‹λ‹¤.
* μ™ ν•„μ”ν•κ°€?\
  μ• ν”λ¦¬μΌ€μ΄μ…μ„ ν…μ¤νΈ ν•  λ• λ¶ν•„μ”ν• λ©”μ„λ“λ“¤λ„ κ°™μ΄ ν…μ¤νΈκ°€ μ΄λ£¨μ–΄μ§€κΈ° λ•λ¬Έμ— νΉμ • λ¶€λ¶„μ„ μ μ™Έν•κ³  ν¨μ¨μ μΌλ΅ ν…μ¤νΈν•κΈ° μ„ν•΄ ν•„μ”ν•λ‹¤.
* νΉμ§•\
  1\) κΈ°μ΅΄μ— μ‚¬μ©λλ μ¤ν”„λ§ Beanμ΄ μ•„λ‹ MockBeanμ„ μ£Όμ…ν•λ‹¤.\
  2\) μ–΄λ…Έν…μ΄μ… λ‚΄λ¶€μ— λ¬Έμμ—΄μ„ λ“±λ΅ν•λ” κ²ƒμ€ κΈ°μ΅΄μ— μ„ μ–Έλ Bean κ°μ²΄λ¥Ό λ®μ–΄μ“°κΈ° μ„ν•¨μ΄λ‹¤.\
  3\) λ§μ•½ Beanμ μ΄λ¦„μ„ κ°•μ λ΅ μ§€μ •ν•μ§€ μ•μΌλ©΄, μ¤ν”„λ§μ—μ„ μ–΄λ–¤ Beanμ„ κ°€μ Έμ™€μ•Ό ν• μ§€ μ•μμ—†μ–΄ μ¤λ¥κ°€ λ°μƒν•λ‹¤.
* μ‚¬μ©λ°©λ²•\

* κ°μΈμ μΈ μƒκ°(μ¶”κ°€μ μΈ μ§λ¬Έ λλ” λ‚΄μ©)\
  λΉ„κµμ  μ μ™Έν•  λ‚΄μ©μ΄λ‚ λ©”μ„λ“κ°€ λ§μ€ λ• μ‚¬μ©ν•΄μ•Ό λλ” κΈ°λ¥μΈ κ²ƒ κ°™λ‹¤.
* λ νΌλ°μ¤ λ¨μ\
  [https://velog.io/@joosing/what-is-mock-bean](https://velog.io/@joosing/what-is-mock-bean)\
  [https://jojoldu.tistory.com/226](https://jojoldu.tistory.com/226)

## @WebMvcTest

* μ •μ \
  Mvcλ¥Ό μ„ν• ν…μ¤νΈ.
* μ™ ν•„μ”ν•κ°€?\

*   νΉμ§•\
    1\) μ›Ήμ—μ„ ν…μ¤νΈν•κΈ° νλ“  μ»¨νΈλ΅¤λ¬λ¥Ό ν…μ¤νΈν•κΈ° μ ν•©ν•λ‹¤.\
    2\) μ›Ήμƒμ—μ„ μ”μ²­κ³Ό μ‘λ‹µμ— λ€ν•΄ ν…μ¤νΈ ν•  μ μλ‹¤.\
    3\) μ‹νλ¦¬ν‹°, ν•„ν„°κΉμ§€ μλ™μΌλ΅ ν…μ¤νΈν•κ³ , μλ™μΌλ΅ μ¶”κ°€/μ‚­μ  κ°€λ¥\
    4\) @SpringBootTest μ–΄λ…Έν…μ΄μ…λ³΄λ‹¤ κ°€λ³κ² ν…μ¤νΈ ν•  μ μλ‹¤.\
    5\) `@Controller`, `@ControllerAdvice`, `@JsonComponent`, `Converter`, `GenericConverter`, `Filter`, `HandlerInterceptor μ™€ κ°™μ€ λ‚΄μ©λ§ μ¤μΊ”ν•λ„λ΅ μ ν•ν•λ‹¤.`\
    `6)μμ΅΄μ„±μ΄ λκΈ°κΈ° λ•λ¬Έμ— μ„λΉ„μ¤μ™€ κ°™μ€ κ°μ²΄λ” MockBeanμ„ μ‚¬μ©ν•΄μ„ λ§λ“¤μ–΄ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.`


* μ‚¬μ©μμ‹\

* κ°μΈμ μΈ μƒκ°(μ¶”κ°€μ μΈ μ§λ¬Έ λλ” λ‚΄μ©)\

* λ νΌλ°μ¤ λ¨μ\
  [https://amaran-th.github.io/Spring/\[Spring\]%20Test/](https://amaran-th.github.io/Spring/\[Spring]%20Test/)
